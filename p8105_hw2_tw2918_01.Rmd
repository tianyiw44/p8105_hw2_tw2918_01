---
title: "p8105_hw2_tw2918_01"
output: github_document
date: "2023-09-30"
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(collapse = TRUE, message = FALSE)
```

```{r load_libraries}
library(tidyverse)
library(readxl)
```

# Probelm 1
## 1. Clean the data in pols-month.csv.
### (1) Use `separate()` to break up the variable `mon` into integer variables `year`, `month`, and `day`

### (2)  replace month number with month abbreviation

### (3) create a `president` variable taking values `gop` and `dem`, and remove `prez_dem` and `prez_gop`

### (4) remove `day` variable 

```{r, eval=FALSE}
month_df = 
  tibble(
    month_num = 1:12,
    month_abb = month.abb,
    month = month.name
  )
```

```{r, eval=FALSE}
pols_month_df = 
  read_csv("./fivethirtyeight_datasets/pols-month.csv")|>
  janitor::clean_names()|>
  separate(mon, into = c("year", "month_num", "day"), convert = TRUE)|>
  mutate(
    president = recode(prez_gop, "0" = "dem", "1" = "gop", "2" = "gop")) |>
  left_join(x = _, y = month_df) |> 
  select(year, month, everything(), -month_abb, -day, -starts_with("prez"))
```
 
## 2. clean the data in snp.csv using a similar process to the above
### (1) Use `separate()` to break up the variable `date` into integer variables `year`, `month`, and `day`
### (2)  replace month number with month abbreviation and remove `day` varialbe
### (3)  arrange according to year and month

```{r, eval=FALSE}
snp_df = 
  read_csv("./fivethirtyeight_datasets/snp.csv")|>
  janitor::clean_names()|>
  separate(date, into = c("month", "day", "year"), convert = TRUE) |>
  arrange(year, month)|>
  mutate(month = month.name[as.numeric(month)])|>
  select(year, month,close)
```

## 3. tidy the unemployment data

```{r, eval=FALSE}
unemp_df = 
  read_csv("./fivethirtyeight_datasets/unemployment.csv")|>
  rename(year = Year) |>
  pivot_longer(
    Jan:Dec, 
    names_to = "month_abb",
    values_to = "unemployment"
  ) |> 
  left_join(x = _, y = month_df) |> 
  select(year, month, unemployment)
```

## 4. Join the datasets by merging `snp` into `pols`, and merging `unemployment` into the result

```{r}
```

# Probelm 2 
## 1. Read and Clearn Mr. Trash Wheel Dataset

```{r}
mr_trashwheel_df = 
  read_excel( "./202207 Trash Wheel Collection Data.xlsx", 
    sheet = "Mr. Trash Wheel",
    range = "A2:N549"
    ) |>
  janitor::clean_names()|>
  mutate(
    homes_powered_new = weight_tons*500/30,
    trash_wheel="mr_trash_wheel",
    year=as.numeric(year)
    ) |>
  select(trash_wheel, everything(), -homes_powered)
```

## 2. Use a similar process to import, clean, and organize the data for Professor Trash Wheel

```{r}
pf_trashwheel_df = 
  read_excel( "./202207 Trash Wheel Collection Data.xlsx", 
    sheet = "Professor Trash Wheel",
    range = "A2:M96"
    ) |>
  janitor::clean_names()|>
  mutate(
    homes_powered_new = weight_tons*500/30,
    trash_wheel = "professor_trash_wheel") |>
  select(trash_wheel, everything(), -homes_powered)
```

## 3. Use a similar process to import, clean, and organize the data for Gwynnda Trash Wheel

```{r}
gwy_trashwheel_df=
  read_excel( "./202207 Trash Wheel Collection Data.xlsx", 
    sheet = "Gwynnda Trash Wheel",
    range = "A2:K108"
    ) |>
  janitor::clean_names()|>
  mutate(
    homes_powered_new = weight_tons*500/30,
    trash_wheel = "gwynnda_trash_wheel") |>
  select(trash_wheel, everything(), -homes_powered)
```

## 4. Combine Datasets 

First, changed the above code to state which trash wheel is which
Second, unify variable type. fixed the column type of year variable in Mr. Trash Wheel Dataset.
Third combine datasets using `full_join` sine we want to keep all values in three datasets. 

```{r}
mr_pf_trashwheel_df = 
  full_join(mr_trashwheel_df, pf_trashwheel_df)

trashwheel_df = 
  full_join(mr_pf_trashwheel_df, gwy_trashwheel_df)
```

## 5. Write a paragraph about the data
The `trashwheel_df` dataset contains data from all three dataset, Mr.Trash Wheel, Professor Trash Wheel and Gwynnda Trash Wheel. It contains `r nrow(trashwheel_df)` observations of trash collected. The data contains `r ncol(trashwheel_df)` variables. The variables include `month` `year` and `date` of the collected `dumspter`, weight of the `dumspter`, measured in tons (`weight_ton`), volume of the `dumspter`, measured in cubic yards (`volume_cubic_yards`) and the type of trash collected, such as `plastic_bottle`, `polysyrene`, `ciagrette_butt`, `glass_bottle`,`grocery_bags`, `chip_bags`, `sports_ball` and `plastic_bags`.There are missing values because each trash wheel collects different types of trash and the combination creates missing values for the type of trash they don't collect. The last variable `homes_powered_new` is number of homes powered by the collected trash, calculated using`weight_ton` times 500 kilowatts of electricity creates per ton, then divided by 30 kilowatts needed per home.

For available data, the total weight of trash collected by Professor Trash Wheel is `r sum(pull(pf_trashwheel_df, weight_tons))`. The total number of cigarette butts collected by Gwynnda in July of 2021 is `r sum(pull(filter(gwy_trashwheel_df, month == "July" & year == "2021"), cigarette_butts))`. 

# Probelm 3
## 1. Import, clean, and tidy the dataset of baseline demographicsã€‚

```{r}
baseline_df = 
  read_csv("./data_mci/MCI_baseline.csv", skip = 1) |>
  janitor::clean_names()|>
  mutate(
    sex = ifelse(sex == 0, "female", "male"),
    apoe4 = ifelse(apoe4 == 0, "non_carrier", "carrier"),
    age_at_onset = replace(age_at_onset, age_at_onset == ".", NA),
  ) |>
  filter(is.na(age_at_onset)|age_at_onset>current_age)
```

